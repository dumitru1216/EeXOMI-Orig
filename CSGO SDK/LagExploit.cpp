#include "LagExploit.hpp"
#include "source.hpp"
#include "player.hpp"
#include "InputSys.hpp"

class CLagExploit : public ILagExploit {
public:
  void Main( bool* bSendPacket ) override;
private:
};

ILagExploit * ILagExploit::Get( ) {
  static CLagExploit instance;
  return &instance;
}

void CLagExploit::Main( bool * bSendPacket ) {
  if( !Source::m_pEngine->IsInGame( ) )
	 return;

  C_CSPlayer* LocalPlayer = C_CSPlayer::GetLocalPlayer( );

  if ( !LocalPlayer || LocalPlayer->IsDead( ) )
	 return;

  if( !g_Vars.misc.lag_exploit )
	 return;

  if( InputSys::Get( )->GetKeyState( g_Vars.misc.lag_exploit_key ) == KeyState::Down  )
	 bSendPacket = false;
}
